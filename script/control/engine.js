import*as t from"../view/map.js";import*as e from"../view/sidebar.js";import*as r from"../view/hotbar.js";import*as s from"../model/unit/actor/hero/hero.js";import*as a from"../model/dungeon/dungeon.js";import*as i from"../model/point.js";import*as n from"./driver.js";import*as o from"../model/unit/actor/hero/kit.js";import*as m from"./audio.js";import*as p from"./keyboard.js";import*as u from"./spawner.js";import*as f from"./rpg.js";import*as d from"./mechanic/traversal.js";import*as c from"./mechanic/combat.js";const l=o.paladin;class h{constructor(){this.map=!1,this.power=!1,this.combat=!1,this.audio=!1,this.tick=100}reveal(o){if(this.map)for(let e of i.range(0,0,t.width,t.height))o.seen.find(o=>o.equals(e))||o.seen.push(e)}}var w=!1,j=!1,g=!1,v=!1,b=!1,y=new URL(document.location).searchParams.has("debug")&&new h;function k(o){var e,r;t.setup(),n.reset(),g&&(e=g.units.indexOf(w),g.units.splice(e,1)),(g=o).enter(w),y&&y.reveal(o);for(r of Array.from(o.seen))t.see(r.x,r.y);n.reset()}function x(){e.warn("Welcome to Loop Dungeons!"),e.warn("Press h for help.")}function L(){if(!w){if(w=new s.Hero,l.apply(w),y&&y.power)for(var o of w.gear)o.level=y.power;x(),y&&!y.audio||m.loop(m.gameplay)}k((j=new a.Dungeon).floors[0])}function D(){y&&document.body.classList.add("debug"),t.setup(),d.setup(),m.setup(),u.setup(),L(),e.setup(),n.setup(),r.setup(),p.setup()}function P(o){v=o}function q(o){b=o}function A(){window.alert("Game over!"),w=!1,L()}function G(){w.dead&&A(),t.update(),e.update(),r.update(),c.autofight();for(var o of g.units)o.turn();e.log("")}export{w as hero,j as dungeon,g as floor,v as explore,b as fight,y as debug,k as enter,L as start,D as setup,P as autoexplore,q as autofight,G as turn};