import*as e from"./map.js";import*as o from"./help.js";import*as t from"./hotbar.js";import*as c from"../control/engine.js";import*as r from"../control/mechanic/traversal.js";import*as n from"../control/mechanic/combat.js";import*as i from"../model/unit/chest.js";import*as l from"../model/unit/stairs.js";const s=document.querySelector("#sidebar"),a=s.querySelector("#messages"),u=s.querySelector("#interact"),m=s.querySelector("#explore"),f=s.querySelector("#fight"),p=s.querySelector("#climb"),h=Array.from(s.querySelectorAll("#hp span")).slice(1,6),d=Array.from(s.querySelectorAll("#xp span")).slice(1,6);function g(e){e.classList.add("active")}function y(e){e.classList.remove("active")}function q(e){g(e),setTimeout(()=>y(e),200)}function S(e,o,t){q(t.target),c.explore?v(!1):r.move(e,o)}function v(e){(e?g:y)(m),c.autoexplore(e)}function x(e){(e?g:y)(f),c.autofight(e),n.autofight()}function k(o,t){for(let e=1;e<=5;e++)e<=t?o[e-1].classList.add("full"):o[e-1].classList.remove("full")}function j(e=!1){e&&q(u);var o=c.floor.units;let t=c.hero.location;var o=o.find(e=>e instanceof i.Chest&&e.location.equals(t)),r=(u.querySelector("img").src=o?"assets/"+o.gear.image:"",u.classList);o?r.add("looting"):r.remove("looting"),e&&(o?o.swap():C("Nothing to loot here..."))}function b(){var e=c.hero;k(h,5-e.wounds),k(d,e.xp),j()}function L(){var e=a.getBoundingClientRect().height;a.style["max-height"]=e+"px"}function w(){q(p);let o=c.hero.location;var e=c.floor.units.find(e=>e instanceof l.Stairs&&o.equals(e));e?e.climb():C("No stairs here...")}function A(){document.querySelector("#north").onclick=e=>S(0,1,e),document.querySelector("#east").onclick=e=>S(1,0,e),document.querySelector("#south").onclick=e=>S(0,-1,e),document.querySelector("#west").onclick=e=>S(-1,0,e),document.querySelector("#help").onclick=e=>o.overlay(e),m.onclick=e=>v(!c.explore),f.onclick=e=>x(!c.fight),u.onclick=e=>j(!0),p.onclick=e=>w(),o.setup(),b(),L()}function C(e){let o=!1;return e.trim()?(o=document.createElement("p")).textContent=e:o=document.createElement("br"),a.append(o),a.scrollTo(0,a.scrollHeight),o}function E(e){C(e).classList.add("warning")}export{g as activate,y as deactivate,q as flash,v as explore,x as fight,b as update,A as setup,C as log,E as warn};